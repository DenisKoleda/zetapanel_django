{% extends "base.html" %}

{% block content %}
<div class="container">
    <!-- Форма поиска -->
    <form method="get" action="">
        <div class="input-field">
            <input type="text" name="q" placeholder="Search tasks..." value="{{ request.GET.q }}" />
            <button type="submit" class="waves-effect waves-light btn">Search</button>
        </div>
    </form>

    <!-- Карточки задач -->
    <div class="row">
        {% for task in tasks %}
        <div class="col s12 m6 l4">
            <div class="card blue-grey darken-1">
                <div class="card-content white-text">
                    <span class="card-title">{{ task.author }}</span>
                    <p>{{ task.ticket_comment|truncatechars:100 }}</p>
                </div>
                <div class="card-action">
                    <a href="{% url 'task_edit' pk=task.pk %}">Edit</a>
                    <a href="{% url 'task_delete' pk=task.pk %}">Delete</a>
                </div>
            </div>
        </div>
        {% empty %}
        <p>No tasks available.</p>
        {% endfor %}
    </div>

    <!-- Пагинация -->
    <ul class="pagination">
        {% if tasks.has_previous %}
        <li class="waves-effect"><a href="?page=1"><i class="material-icons">first_page</i></a></li>
        <li class="waves-effect"><a href="?page={{ tasks.previous_page_number }}"><i class="material-icons">chevron_left</i></a></li>
        {% else %}
        <li class="disabled"><a href="#!"><i class="material-icons">first_page</i></a></li>
        <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
        {% endif %}

        <!-- Текущая страница и всего страниц -->
        <li class="active"><a href="#!">{{ tasks.number }} of {{ tasks.paginator.num_pages }}</a></li>

        {% if tasks.has_next %}
        <li class="waves-effect"><a href="?page={{ tasks.next_page_number }}"><i class="material-icons">chevron_right</i></a></li>
        <li class="waves-effect"><a href="?page={{ tasks.paginator.num_pages }}"><i class="material-icons">last_page</i></a></li>
        {% else %}
        <li class="disabled"><a href="#!"><i class="material-icons">chevron_right</i></a></li>
        <li class="disabled"><a href="#!"><i class="material-icons">last_page</i></a></li>
        {% endif %}
    </ul>
</div>
{% endblock %}
